name: "Full Recon Pipeline"
description: "Complete offensive pipeline: enum (multi-source) → probe → internal crawl → filter → attack"

steps:
  - name: subdomain_scan
    type: subfinder
    config:
      threads: 30
    output_as: subdomains

  - name: amass_scan
    type: amass
    config:
      timeout: 20
    output_as: amass_results

  - name: live_filter
    type: httpx
    depends_on: [subdomain_scan, amass_scan]
    config:
      targets_from: [subdomains, amass_results]
      threads: 50
    output_as: live_hosts

  - name: endpoint_crawl
    type: ultrafinder_crawler
    depends_on: [live_filter]
    config:
      targets_from: live_hosts
      depth: 3
      threads: 15
      js_crawl: true
      include_subs: false
    output_as: endpoints

  - name: param_filter
    type: paramfilter
    depends_on: [endpoint_crawl]
    config:
      targets_from: endpoints
    output_as: attack_urls

  - name: vuln_scan
    type: nuclei
    depends_on: [live_filter]
    config:
      targets_from: live_hosts
      severity: "critical,high,medium"
      threads: 25
    output_as: vulns

  - name: xss_scan
    type: dalfox
    depends_on: [param_filter]
    config:
      targets_from: attack_urls
    output_as: xss_results

  - name: sqli_scan
    type: sqlmap
    depends_on: [param_filter]
    config:
      targets_from: attack_urls
    output_as: sqli_results
